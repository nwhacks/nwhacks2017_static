Polymer({is:'register-form',properties:{valid:{type:Boolean,value:function(){return!0}},githubURL:{computed:'updateGithubURL(data.github)'},citiesURL:{computed:'updateCitiesURL(data.city, cityFocused)'},citiesClean:{computed:'cleanCities(cities)'},data:{type:Object,notify:!0,value:function(){return{travel_reimbursement:!1,first_hackathon:!1,mentor:!1}}},alreadyRegistered:{value:!1}},observers:['checkEmail(data.email)'],checkEmail:function(a){if(console.log('email',a),this.checkEmailTimeout&&(clearTimeout(this.checkEmailTimeout),this.checkEmailTimeout=!1),!!a){var b=this;this.checkEmailTimeout=setTimeout(function(){b.checkEmailTimeout=!1,firebase.database().ref('emails').child(btoa(b.data.email)).once('value').then(function(c){var d=c.val();b.alreadyRegistered=!!d})},200)}},attached:function(){var a=this;setTimeout(function(){a.$.form.validate()},1)},updateGithubURL:function(a){return a?'https://api.github.com/users/'+a:''},updateCitiesURL:function(a,b){return a&&b?'https://api.teleport.org/api/cities/?limit=5&search='+a:''},cleanCities:function(a){return a&&a._embedded['city:search-results']},selectCity:function(a){this.set('data.city',a.model.item.matching_full_name)},cleanFileName:function(a){return a.replace(/[^A-Za-z0-9\.\-\(\)]+/g,'-')},submit:function(){var a=this;if(this.valid=this.$.form.validate(),this.valid){this.$.submitting.open();const c=firebase.database().ref('ids').push().key,d=this.$.resume.inputElement.files;var b=Promise.resolve();if(0<d.length){const f=d[0],g=this.cleanFileName(f.name),h='resumes/'+c+'-'+g;this.data.resume=h,b=firebase.storage().ref(h).put(f)}b.then(function(){return firebase.database().ref('registrations').child(c).set(a.data)}).then(function(){return firebase.database().ref('emails').child(btoa(a.data.email)).set(!0)}).then(function(f){console.log('Registered',f),a.$.submitting.close(),a.$.registered.open()}).catch(function(f){console.log('Error!',f),a.error=f,a.$.submitting.close(),a.$.error.open()})}}});var config={apiKey:'AIzaSyBou6z9QA7zvCpxUFLoTbwQZcWuBn47yEA',authDomain:'nwhacks-96701.firebaseapp.com',databaseURL:'https://nwhacks-96701.firebaseio.com',storageBucket:'nwhacks-96701.appspot.com',messagingSenderId:'874137730051'};firebase.initializeApp(config);