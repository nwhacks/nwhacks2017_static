var patterns={"University of British Columbia":["UBC","University of British Columbia","University of the British Columbia","University of British Colombia","university british columbia"],"Simon Fraser University":["SFU","Simon Fraser","Somion Fraser"],"University of Waterloo":["Waterloo"],BCIT:["BCIT","British Columbia Institute of Technology"],"University of Illinois Urbana-Champaign":["Urbana-Champaign","Urbana Champaign"],"McGill University":["McGill"],"University of Washington":["University of Washington","UW","University of Washingon"]},patternsCities={Vancouver:["UBC","University of British Columbia","Vanouver","Vancouver","Gage","Marine Drive","Locally","Vancover","Campus","N/a","University of the British Columbia","University of British Colombia","university british columbia"],Seattle:["University of Washington"]};Polymer({is:"stats-page",observers:["handleRegistrations(registrations)","renderData(hackers)"],handleRegistrations:function(t){var e=[];for(var a in t){var r=t[a];r.id=a,e.push(r)}this.hackers=e},renderData:function(t){t.sort(function(t,e){return e.id-t.id}),_.each(this.charts,function(t){t.destroy()}),this.charts=[];var e=this.charts;this.registrationCount=t.length;var a={},r={},o={},s=0,i=0,n=0,c={labels:["S","M","L","XL"],datasets:[{label:"Offered Sizes",backgroundColor:"rgba(220,0,0,0.5)",borderColor:"rgba(220,0,0,0.8)",data:[0,0,0,0]}]},d={labels:["No Response","Going"],datasets:[{data:[0,0],backgroundColor:["#666","#4BAE74"],hoverBackgroundColor:["#888","#377F54"]}]},l=this;_.each(t,function(t){_.each(patterns,function(e,a){_.each(e,function(e){t.school.toLowerCase().trim().indexOf(e.toLowerCase())>=0&&(t.school=a)})}),_.each(patternsCities,function(e,a){_.each(e,function(e){t.city.toLowerCase().trim().indexOf(e.toLowerCase())>=0&&(t.city=a)})}),t.email=t.email.toLowerCase().trim();var e=t.email,h=r[e]&&"accepted"!=t.status||r[e]&&"accepted"==r[e].status;if(t.acceptance_sent&&"accepted"==t.status){const u=t.rsvp?1:0;d.datasets[0].data[u]++}if(!h){if(s++,r[e]=t,"accepted"==t.status&&t.rsvp){var u=c.labels.indexOf(t.tshirt);c.datasets[0].data[u]+=1}a[t.school]||(a[t.school]={name:t.school,accepted:0,acceptedResp:0,total:0}),a[t.school].total+=1;var p=l.toTitleCase(t.city.split(",")[0].trim());o[p]||(o[p]={name:p,accepted:0,acceptedResp:0,total:0}),o[p].total+=1,"accepted"==t.status&&(a[t.school].accepted+=1,o[p].accepted+=1,i++),t.acceptance_sent&&n++,t.rsvp&&(a[t.school].acceptedResp+=1,o[p].acceptedResp+=1)}}),document.getElementById("regDeDup").innerText=s,document.getElementById("accepted").innerText=i,document.getElementById("offered").innerText=n;var t={labels:[],datasets:[{label:"Total Students",backgroundColor:"rgba(220,0,0,0.5)",borderColor:"rgba(220,0,0,0.8)",data:[]},{label:"Offered Students",backgroundColor:"rgba(0,0,220,0.5)",borderColor:"rgba(0,0,220,0.8)",data:[]},{label:"Accepted Students",backgroundColor:"rgba(0,220,220,0.5)",borderColor:"rgba(0,220,220,0.8)",data:[]}]},h=_(a).toArray().sortBy(["accepted","total"]).reverse().value();_.each(h,function(e){t.labels.push(e.name),t.datasets[0].data.push(e.total),t.datasets[1].data.push(e.accepted),t.datasets[2].data.push(e.acceptedResp)});var u=document.getElementById("university").getContext("2d");e.push(new Chart(u,{type:"bar",data:t,options:{responsive:!1}},{}));var p={labels:[],datasets:[{label:"Total Students",backgroundColor:"rgba(0,220,0,0.5)",borderColor:"rgba(0,220,0,0.8)",data:[]},{label:"Offered Students",backgroundColor:"rgba(0,0,220,0.5)",borderColor:"rgba(0,0,220,0.8)",data:[]},{label:"Accepted Students",backgroundColor:"rgba(0,220,220,0.5)",borderColor:"rgba(0,220,220,0.8)",data:[]}]},b=_(o).toArray().sortBy(["accepted","total"]).reverse().value();_.each(b,function(t){p.labels.push(t.name),p.datasets[0].data.push(t.total),p.datasets[1].data.push(t.accepted),p.datasets[2].data.push(t.acceptedResp)});var u=this.$.city.getContext("2d");e.push(new Chart(u,{type:"bar",data:p,options:{responsive:!1}},{}));var u=this.$.tshirt.getContext("2d");e.push(new Chart(u,{type:"bar",data:c,options:{responsive:!1}},{}));var u=this.$.response.getContext("2d");e.push(new Chart(u,{type:"doughnut",data:d,options:{responsive:!1}},{})),this.$.going.innerText=d.datasets[0].data[1]},toTitleCase:function(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}});