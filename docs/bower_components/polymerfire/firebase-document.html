<html><head><link rel="import" href="../polymer/polymer.html"><link rel="import" href="firebase-database-behavior.html"><script>'use strict';Polymer({is:'firebase-document',behaviors:[Polymer.FirebaseDatabaseBehavior],attached:function(){this.__refChanged(this.ref,this.ref)},detached:function(){this.ref&&this.ref.off('value',this.__onFirebaseValue,this)},observers:['__refChanged(ref)'],get isNew(){return this.disabled||!this.__pathReady(this.path)},get zeroValue(){return{}},save:function(a,b){return new Promise(function(c,d){var e;this.app||d(new Error('No app configured!')),b?(e=a+'/'+b,c(this._setFirebaseValue(e,this.data))):e=firebase.database(this.app).ref(a).push(this.data,function(f){return f?void d(f):void c()}).path.toString(),this.path=e}.bind(this))},reset:function(){return this.path=null,Promise.resolve()},destroy:function(){return this._setFirebaseValue(this.path,null).then(function(){return this.reset()}.bind(this))},memoryPathToStoragePath:function(a){var b=this.path;return'data'!==a&&(b+=a.replace(/^data\.?/,'/').split('.').join('/')),b},storagePathToMemoryPath:function(a){var b='data';return a=a.replace(this.path,'').split('/').join('.'),a&&(b+='.'+a),b},getStoredValue:function(a){return new Promise(function(b){this.db.ref(a).once('value',function(d){var e=d.val();null==e&&b(this.zeroValue),b(e)},this.__onError,this)}.bind(this))},setStoredValue:function(a,b){return this._setFirebaseValue(a,b)},__refChanged:function(a,b){b&&b.off('value',this.__onFirebaseValue,this),a&&a.on('value',this.__onFirebaseValue,this.__onError,this)},__onFirebaseValue:function(a){var b=a.val();null==b&&(b=this.zeroValue),this.new||this.async(function(){this.syncToMemory(function(){this._log('Updating data from Firebase value:',b),this.set('data',b)})})}});</script></head><body></body></html>